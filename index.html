<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>Storytelling Project</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="vendor/noUiSlider-12.1.0/nouislider.min.css" rel="stylesheet" />

    <!-- <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css"> -->
    <link
      href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
      rel="stylesheet"
      type="text/css"
    />
    <link href="vendor/clean-blog/css/clean-blog.min.css" rel="stylesheet" />

    <!-- Story CSS files -->
    <link href="story.css" rel="stylesheet" />
    <link href="mentions-bar-chart.css" rel="stylesheet" />
  </head>

  <body>
    <!-- Page Header -->
    <header class="masthead top-background">
      <div class="overlay"></div>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <div class="post-heading">
              <h1>News Progagation During the 2018 Brazilian Presidential Election</h1>
              <h2 class="subheading">
                The political debate was highly polarized and led to the victory of the candidate with the most
                "negative" stories in the news.
              </h2>
              <span class="meta">Elaborated by Aécio Santos, Anas Elghafari, and Sonia Castelo.</span>
              <span>December, 2018.</span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Post Content -->
    <article>
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-md-12 mx-auto main-article">
            <p>
              In 2018, Brazil had its 8<sup>th</sup> direct democratic presidential election since the end of the
              military dictatorship in 1985. It was arguably one of the most controversial elections since the beginning
              of the young Brazilian democracy. During the pre-election period, we monitored hundreds of Brazilian news
              sources and compiled a database with thousands of election-related news stories that mentioned the
              presidential candidates. In this article, we showcase various aspects of the election through
              the lenses of data.
            </p>

            <h2 class="section-heading">The Data</h2>
            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  Our data comes from crawling 140 Brazilian news websites. Those include all the major news websites
                  (such as <i>globo.com</i>, <i>em.com.br</i>, and <i>uol.com.br</i>) as well as a sample of not so mainstream
                  news sites.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-data mt-3"
                  title="number of websites covered"
                  src="images/data-img1.png"
                />
              </div>
            </div>

            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  The election had 2 rounds. The first round was on October 7th and the second round (the run-off between
                  the top two candidates) was on October 28th. Our data covers the final 4 months of the campaign.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-data mt-4"
                  title="duration of coverage"
                  src="images/data-img2.png"
                />
              </div>
            </div>

            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  While our crawl yielded hundreds of thousands of web pages, we focused on those that had text content
                  (which exlude video pages), were covering the election and the candidates, and were part of a story.
                  There were 64,661 news articles that matched those criteria.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-data mt-4"
                  title="number of articles"
                  src="images/data-img3.png"
                />
              </div>
            </div>

            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  The same story, the same event, is often covered by many websites. While an article is simply a web page
                  from a specific site, our goal is to understand stories: collections of articles that are reporting about the
                  same event, using similar language. We used text clustering to group articles from different websites that are
                  similar to each other. The results were 18,837 news stories, ranging in size from 82 articles in the biggest story to 2.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-data mt-4"
                  title="number of stories"
                  src="images/data-img4.png"
                />
              </div>
            </div>



            <h2 class="section-heading">The news mention medalists</h2>
            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  According to our news database, <i class="text-blue">Jair Bolsonaro</i> was by far the most popular
                  candidate in terms of mentions in article headlines. His polarizing and controversial views have been
                  described as <i>far-right</i> and conservative, drawing both praise and criticism in Brazil.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-candidate mt-3"
                  title="Jair Bolsonaro. Source: Wikipedia"
                  src="images/150px-Jair_Bolsonaro.jpg"
                />
              </div>
            </div>

            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  The second most popular is <i class="text-red">Lula</i>, the former 35<sup>th</sup> Brazilian
                  president (2003-2011). Shortly after announcing his candidacy, he was disqualified from running by the
                  Superior Electoral Court (STF) on 31 August 2018 for being previously convicted on corruption charges
                  in a controversial court ruling.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-candidate mt-4"
                  title="Luis Inácio Lula da Silva. Source: Wikipedia"
                  src="images/250px-Lula.jpg"
                />
              </div>
            </div>

            <div class="row no-gutters">
              <div class="col-lg-9">
                <p>
                  <i class="text-red">Fernando Haddad</i> was the 3<sup>rd</sup> most frequently mentioned. He was named
                  as Lula's replacement on September 1<sup>st</sup> on the Worker's Party coalition, which was
                  officially approved on <i>September 25<sup>th</sup></i
                  >. His candidacy has been criticized for its strategy of trying to inherit Lula's popularity.
                </p>
              </div>
              <div class="col-lg-3">
                <img
                  class="img-candidate mt-3"
                  title="Fernando Haddad. Source: Wikipedia"
                  src="images/150px-Fernando_Haddad.jpg"
                />
              </div>
            </div>

            <div id="mentions-bar-chart" class="chart mt-5">
              <svg width="730" height="500"></svg>
              <div class="legend-container">
                <div class="legend">
                  <div class="block" style="background-color:#1676B6"></div>
                  <span>PSL (Social Liberal Party)</span>
                </div>
                <div class="legend">
                  <div class="block" style="background-color:#D9241E"></div>
                  <span>PT (Worker's Party)</span>
                </div>
                <div class="legend">
                  <div class="block" style="background-color:#7F7F7F"></div>
                  <span>Others</span>
                </div>
              </div>
              <p class="chart-caption">
                Number of presidential candidates mentions in article headlines during the pre-election period of the
                2018 Brazilian Elections.
              </p>
            </div>


            <h4 class="section-heading">What was the news talking about?</h4>

            <p>
              To gain insight into the topics that bolstered candidate's news mentions, we delved into the textual content of the
              stories. The following chart shows the most frequent words occurring in the article headlines from our database. In
              conformance with candidate mentions, <i>Bolsonaro</i> is the most common word.
            </p>
            <div class="chart">
              <div id="wordcloud-news" class="chart"></div>
              <p class="chart-caption">Word cloud of most frequent words in article headlines.</p>
            </div>

            <p>
              We also examined frequent words that appear associated exclusively with each of the top 3 candidates. For instance, when we look at Bolsonaro-related articles, his tragic stabbing in September 6, 2018, explains a large fraction of the most frequent terms (e.g., <i>albert, eistein, adélio, cirurgia, agressor, intestino, UTI, esfaqueado, lesão, sangue, estáve,</i> and others). Additionally, we can see words such as <i>racismo, gays,</i> and <i>negras</i> that allude to his heinous statements concerning minorities.
            </p>

            <div class="chart">
              <div id="wordcloud-bolsonaro" class="chart"></div>
              <p class="chart-caption">Word-cloud of most frequent words in articles that mention Bolsonaro.</p>
            </div>

            <p>
              When we look at the left-leaning candidates, Lula and Haddad, we see a different picture. For Lula, most terms seem
              to be judge names (e.g., <i>Favreto, Fachin, Gebran, Lewandowski, Zanin</i>), juridic terms related to his judicial
              process (<i>habeas, corpus, TRF, apartamento, triplex, soltura</i>), or related to his candidacy rejection (<i>rejeitou</i>) .
            </p>
            <div class="chart">
              <div id="wordcloud-lula" class="chart"></div>
              <p class="chart-caption">Word-cloud of most frequent words in articles that mention Lula.</p>
            </div>

            <p>
              For Haddad, the terms seem to be related to particular cases that involved him. For example, UTC refers to an
              engineering company involved in a corruption proceeding, in which Haddad has been accused of receiving bribes while he
              was a São Paulo major. The term <i>desinformação</i> (disinformation) is linked to articles associated with an
              accusation that the marketing campaign phrase "Haddad is Lula" is misleading and produces disinformation.
            </p>
            <div class="chart">
              <div id="wordcloud-haddad" class="chart"></div>
              <p class="chart-caption">Word-cloud of most frequent words in articles that mention Haddad.</p>
            </div>

            <h2 class="section-heading">The spread of news online</h2>

            <p>
              Websites do not publish original content only. To measure the extent to which articles propagate on the
              Web, we tracked news stories that were re-published in different sites from its original source. We then
              grouped these re-published articles in clusters, which are shown in the next chart. The colors represent
              the main candidate mentioned in the cluster's stories headlines. The height and bubble size to represent
              the cluster size, i.e., the number of different sites that re-published the stories. The cluster size can
              be seen as a way to describe the reach of a story. Clearly, some stories got more traction than others and
              therefore became more popular.
            </p>

            <div class="chart wide-chart-sm">
              <div id="bubble-chart"></div>
              <p class="chart-caption">
                Clusters of news articles that were re-published in websites different from its original source. Each
                bubble represents a cluster of similar articles. The color represents the candidate that each article
                cluster mentions in its headline.
              </p>
            </div>

            <h2 class="section-heading">News traveled fast</h2>
            <p>
              News spread quickly after its publication. In fact, most of the stories are re-published in other sites
              within a few minutes. The next chart illustrates the speed which news stories spread to other sites by
              showing how the number of publications within a cluster grows over time. Each line represents a cluster of
              stories and the colors represent the main candidate mentioned in the story headline. Most clusters follow
              a pattern of quick growth in the beginning and a slow growth toward the end.
            </p>

            <div class="chart wide-chart row no-gutters">
              <div id="propagation-speed-chart" class="col chart propagation-speed-chart"></div>
              <div class="col chart-table-container">
                <div id="google_translate_element"></div>
                <div id="top-clusters-table" class="table-responsive-sm"></div>
              </div>
            </div>

            <!-- <h2 class="section-heading">Does candidate popularity in news articles reflect the election results?</h2> -->
            <h2 class="section-heading">News mentions and the opinion polls</h2>

            <p>
              We now move on to investigate the relationship between the news coverage mentions and the public opinion
              polls. First Let us look at how the opinion polls fluctuated over the duration of the campaign.
            </p>

            <blockquote class="blockquote">
              You can filter the visualization by clicking on the icons located in the legend. To reset the
              visualization, please click on the last clicked icon.
            </blockquote>

            <div class="chart wide-chart-sm scatter-plot" id="scatter-plot-poll"></div>

            <div class="chart wide-chart-sm scatter-plot" id="line-plot-popularity"></div>

            <h2 class="section-heading">Conclusion</h2>
            <p>
              We can see that Bolsonaro has dominated the news coverage throughout the campaign period. What is
              interesting, is that a lot of the stories were not positive. There was a lot of negative coverage about
              his statement and his tactics (cite examples here from the top stories). However, his polling numbers did
              not seem to get affected by those negative stories. Instead, we can see a correlation between his polling
              numbers and his mentions (regardless of whether those mentions were positive or negative). In conclusion,
              in the story of Bolsonaro and the Brazilian elections, we can see the truth of the saying "There is no
              such thing as a bad publicity".
            </p>
          </div>
        </div>
      </div>
    </article>

    <hr />

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <p class="copyright text-muted">
              Project developed for the Information Visualization (Fall 2018) course at NYU Tandon School of
              Engineering.
            </p>
          </div>
        </div>
      </div>
    </footer>
    <!-- D3.js -->
    <script src="d3.js"></script>
    <script src="vendor/noUiSlider-12.1.0/nouislider.min.js"></script>
    <script src="vendor/noUiSlider-12.1.0/wNumb.js"></script>
    <script src="candidate-mentions-bar-chart.js"></script>
    <script src="propagation-speed.js"></script>
    <script src="wordcloud_news.js"></script>
    <script src="d3.layout.cloud.js"></script>
    <script src="scatterplot-poll.js"></script>
    <script src="popularity_plot.js"></script>
    <script>
      // const csvFile = 'data/BR-elections-articles-v3.2.csv.no-exact-dups.lsh-0.6.csv';
      // const TIMESTAMP_HEADER = 'timestamp';
      // const DEFAULT_MIN_DATE = '2018-09-01';
      // const DEFAULT_MAX_DATE = '2018-09-11';

      const csvFile = "data/BR-Crawl-Articles-Clustered-NoText.csv";
      const TIMESTAMP_HEADER = "crawl_timestamp"; //'article_timestamp';
      const DEFAULT_MIN_DATE = "2018-08-01";
      const DEFAULT_MAX_DATE = "2018-10-30";

      const store = {};

      function loadData() {
        return Promise.all([d3.csv(csvFile)]).then(datasets => {
          store.data = datasets[0];
          return store;
        });
      }

      function parseCsvDataTypes(data) {
        data = data.filter(d => d[TIMESTAMP_HEADER]);
        data = data.filter(d => d.domain !== "ocafezinho.com"); // BAD data
        data.forEach(d => {
          d.cluster_id = +d.cluster_id;
          d.date = new Date(d[TIMESTAMP_HEADER]);
        });
        return data;
      }

      function filterStoriesByDate(data, min, max) {
        let minDate = new Date(min) || new Date(DEFAULT_MIN_DATE);
        let maxDate = new Date(max) || new Date(DEFAULT_MAX_DATE);
        return data.filter(d => d.date <= maxDate && d.date >= minDate);
      }

      function filterStoriesByClusterSize(clusters, min, max) {
        let minSize = typeof min === "undefined" ? DEFAULT_MIN_CLUSTER_SIZE : min;
        let maxSize = typeof max === "undefined" ? Number.MAX_SAFE_INTEGER : max;
        return clusters.filter(c => c.length <= maxSize && c.length >= minSize);
      }

      function groupByClusterId(data) {
        let result = {};
        data.forEach(function(d) {
          let group = result[d.cluster_id] || [];
          group.push(d);
          result[d.cluster_id] = group;
        });
        // converts the results object into an array
        result = Object.keys(result).map(key => {
          // sorts each stories cluster by date
          return result[key].sort((a, b) => d3.ascending(a.date, b.date));
        });
        // make sure clusters are sorted from largest to smallest
        result.sort((a, b) => d3.descending(a.length, b.length));
        return result;
      }

      function concatenatedHeadlines(data) {
        var badWords = [",", ":", "de", "para"];
        var text = [];
        data.forEach(function(d) {
          var temp_text = d.headline
            .toLowerCase()
            .replace(
              / de | para | do | e | por |:|,|;| pelo | por | na | a | o | da | é | ao | com | em | que | no | se | tem | sobre | diz /gi,
              ""
            );
          text.push(temp_text);
        });
        var temp = text.filter(function(word) {
          return !(word in badWords);
        });
        var concatenated_headlines = text.join(" ");
        return concatenated_headlines;
      }

      function showData() {
        let data = store.data;
        console.log("data.length:" + data.length);

        data = parseCsvDataTypes(data);
        console.log("data.length:" + data.length);

        data = filterStoriesByDate(data, DEFAULT_MIN_DATE, DEFAULT_MAX_DATE);
        console.log("data.length:" + data.length);

        clusters = groupByClusterId(data);
        console.log("clusters.length:" + clusters.length);

        drawProgagationSpeedChart({
          tagId: "#propagation-speed-chart",
          data: data,
          clusters: clusters,
          min: 15
        });

        // drawProgagationSpeedChart({
        //   tagId: '#propagation-speed-chart-min-size',
        //   data: data,
        //   clusters: clusters,
        //   slider: false,
        //   table: false,
        //   min: 20,
        //   max: 41,
        // });
        renderBubbleChart("#bubble-chart", data, clusters);
      }

      //
      // Load word cloud charts
      //
      d3.json("data/word-frequency.json").then(data => {
        store.wordFrequencies = data;
        renderWordCloud("#wordcloud-news", store.wordFrequencies);
      });
      d3.json("data/bolsonaro-word-frequency.json").then(data => {
        store.wordFrequencies = data;
        renderWordCloud("#wordcloud-bolsonaro", store.wordFrequencies);
      });
      d3.json("data/haddad-word-frequency.json").then(data => {
        store.wordFrequencies = data;
        renderWordCloud("#wordcloud-haddad", store.wordFrequencies);
      });
      d3.json("data/lula-word-frequency.json").then(data => {
        store.wordFrequencies = data;
        renderWordCloud("#wordcloud-lula", store.wordFrequencies);
      });
      
      //
      // Load public opnion polls charts
      //
      d3.csv("data/opinion-polls.csv").then(data => {
        renderPollScatterPlotChart(data, DEFAULT_MIN_DATE, DEFAULT_MAX_DATE);
      });
      d3.csv("data/Headline_mentions_per_candidate_per_day_cleaned.csv").then(data => {
        renderPopularityPlot(data, DEFAULT_MIN_DATE, DEFAULT_MAX_DATE);
      });

      loadData().then(showData);
    </script>

    <script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement({ pageLanguage: "pt" }, "google_translate_element");
      }
    </script>
    <script
      type="text/javascript"
      src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
    ></script>
  </body>
</html>
